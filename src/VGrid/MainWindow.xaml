<Window x:Class="VGrid.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:VGrid"
        xmlns:converters="clr-namespace:VGrid.Converters"
        mc:Ignorable="d"
        Title="{Binding WindowTitle}" Height="600" Width="900"
        KeyDown="Window_KeyDown"
        PreviewKeyDown="Window_PreviewKeyDown">

    <Window.Resources>
        <converters:ModeToColorConverter x:Key="ModeToColorConverter"/>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    </Window.Resources>

    <DockPanel>
        <!-- Menu Bar -->
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="_File">
                <MenuItem Header="_New" Command="{Binding NewFileCommand}" InputGestureText="Ctrl+N"/>
                <MenuItem Header="_Open..." Command="{Binding OpenFileCommand}" InputGestureText="Ctrl+O"/>
                <MenuItem Header="_Save" Command="{Binding SaveFileCommand}" InputGestureText="Ctrl+S"/>
                <MenuItem Header="Save _As..." Command="{Binding SaveAsFileCommand}"/>
                <Separator/>
                <MenuItem Header="E_xit" Command="{Binding ExitCommand}"/>
            </MenuItem>
            <MenuItem Header="_Edit">
                <MenuItem Header="_Undo" Command="{Binding UndoCommand}" InputGestureText="u (in Normal mode)"/>
                <MenuItem Header="_Redo" Command="{Binding RedoCommand}" InputGestureText="Ctrl+R"/>
            </MenuItem>
        </Menu>

        <!-- Status Bar -->
        <StatusBar DockPanel.Dock="Bottom" Height="30">
            <StatusBarItem>
                <StackPanel Orientation="Horizontal">
                    <Border Background="{Binding StatusBarViewModel.ModeBrush}"
                            CornerRadius="3" Padding="8,2" Margin="0,0,10,0">
                        <TextBlock Text="{Binding StatusBarViewModel.ModeText}"
                                   Foreground="White" FontWeight="Bold"/>
                    </Border>
                    <TextBlock Text="{Binding StatusBarViewModel.PositionText}"
                               Margin="10,0" VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding StatusBarViewModel.MessageText}"
                               Margin="20,0" VerticalAlignment="Center" FontStyle="Italic"/>
                </StackPanel>
            </StatusBarItem>
        </StatusBar>

        <!-- Main Grid Area -->
        <Border BorderBrush="Gray" BorderThickness="1" Margin="5">
            <DataGrid x:Name="TsvGrid"
                      ItemsSource="{Binding GridViewModel.Rows}"
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      CanUserReorderColumns="False"
                      CanUserSortColumns="False"
                      SelectionMode="Single"
                      SelectionUnit="Cell"
                      GridLinesVisibility="All"
                      HeadersVisibility="Column"
                      Margin="0">
                <!-- Columns will be generated dynamically in code-behind -->
            </DataGrid>
        </Border>
    </DockPanel>
</Window>
